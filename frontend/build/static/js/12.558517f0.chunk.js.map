{"version":3,"sources":["actions/verifyEmail.js","img/danger.svg","actions/newCode.js","pages/Verify.js"],"names":["verifyEmailAction","enteredCode","dispatch","getState","a","type","userInfo","token","user","status","cancelToken","axios","CancelToken","source","config","headers","Content_Type","Authorization","post","code","Number","localStorage","setItem","JSON","stringify","payload","response","data","message","newCodeAction","get","StyledVerify","styled","div","Verify","useState","setCode","codeError","setCodeError","useSelector","state","verificationError","verifyLoading","newCodeError","newCodeLoading","timer","setTimer","startTimer","setStartTimer","getItem","parse","timerSeconds","location","useLocation","useEffect","setTimeout","prevTime","removeItem","useDispatch","history","useHistory","redirect","search","split","order","name","error","push","className","src","danger","alt","hidden","vibrating","visiblity","length","msg","includes","onSubmit","e","preventDefault","email","to","maxLength","value","onChange","target","id","placeholder","onClick"],"mappings":"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","file":"static/js/12.558517f0.chunk.js","sourcesContent":["import axios from \"axios\"\r\n\r\nexport const verifyEmailAction = (enteredCode) => async (\r\n  dispatch,\r\n  getState\r\n) => {\r\n  dispatch({ type: \"VERIFY_REQUEST\" })\r\n  const userInfo = getState().userInfo\r\n  if (userInfo.token && userInfo.user.status === \"pending\") {\r\n    try {\r\n      const cancelToken = axios.CancelToken\r\n      const source = cancelToken.source()\r\n\r\n      const config = {\r\n        headers: {\r\n          Content_Type: \"application/json\",\r\n          Authorization: `Bearer ${userInfo.token}`,\r\n        },\r\n        cancelToken: source.token,\r\n      }\r\n      await axios.post(\r\n        \"/api/users/getSecurityCode\",\r\n        { code: Number(enteredCode) },\r\n        config\r\n      )\r\n      dispatch({ type: \"VERIFY_SUCCESS\" })\r\n\r\n      localStorage.setItem(\r\n        \"sickUserInfo\",\r\n        JSON.stringify({\r\n          user: getState().userInfo.user,\r\n          token: getState().userInfo.token,\r\n        })\r\n      )\r\n    } catch (error) {\r\n      dispatch({\r\n        type: \"VERIFY_FAIL\",\r\n        payload:\r\n          error.response && error.response.data.message\r\n            ? error.response.data.message\r\n            : error.message,\r\n      })\r\n    }\r\n  }\r\n}\r\nexport default verifyEmailAction\r\n","export default __webpack_public_path__ + \"static/media/danger.52622ca6.svg\";","import axios from \"axios\"\r\n\r\nexport const newCodeAction = () => async (dispatch, getState) => {\r\n  dispatch({ type: \"NEW_VERIFY_CODE_REQUEST\" })\r\n  const userInfo = getState().userInfo\r\n  if (userInfo.token && userInfo.user.status === \"pending\") {\r\n    try {\r\n      const cancelToken = axios.CancelToken\r\n      const source = cancelToken.source()\r\n      const config = {\r\n        headers: {\r\n          Content_Type: \"application/json\",\r\n          Authorization: `Bearer ${userInfo.token}`,\r\n        },\r\n        cancelToken: source.token,\r\n      }\r\n      await axios.get(\"/api/users/getNewSecurityCode\", config)\r\n      dispatch({ type: \"NEW_VERIFY_CODE_SUCCESS\" })\r\n    } catch (error) {\r\n      dispatch({\r\n        type: \"NEW_VERIFY_CODE_FAIL\",\r\n        payload:\r\n          error.response && error.response.data.message\r\n            ? error.response.data.message\r\n            : error.message,\r\n      })\r\n    }\r\n  }\r\n}\r\nexport default newCodeAction\r\n","import React, { useEffect, useState } from \"react\"\r\nimport styled from \"styled-components\"\r\nimport verifyEmailAction from \"../actions/verifyEmail\"\r\nimport danger from \"../img/danger.svg\"\r\nimport { useDispatch, useSelector } from \"react-redux\"\r\nimport Message from \"../components/message\"\r\nimport Loader from \"../components/loader\"\r\nimport { Link, useHistory, useLocation } from \"react-router-dom\"\r\nimport newCodeAction from \"../actions/newCode\"\r\n\r\nconst Verify = () => {\r\n  const [code, setCode] = useState(\"\")\r\n  const [codeError, setCodeError] = useState(\"\")\r\n  const {\r\n    verificationError,\r\n    verifyLoading,\r\n    user,\r\n    newCodeError,\r\n    newCodeLoading,\r\n  } = useSelector((state) => state.userInfo)\r\n  const [timer, setTimer] = useState(0)\r\n  const [startTimer, setStartTimer] = useState(false)\r\n  const status = user ? user.status : \"\"\r\n\r\n  const [timerSeconds] = useState(\r\n    localStorage.getItem(\"sickTimerSeconds\")\r\n      ? JSON.parse(localStorage.getItem(\"sickTimerSeconds\"))\r\n      : 60\r\n  )\r\n\r\n  const location = useLocation()\r\n  useEffect(() => {\r\n    if (startTimer) {\r\n      setTimeout(() => {\r\n        if (timer > 0) {\r\n          setTimer((prevTime) => prevTime - 1)\r\n          localStorage.setItem(\"sickTimerSeconds\", timer)\r\n        } else {\r\n          setStartTimer(false)\r\n          localStorage.removeItem(\"sickTimerSeconds\")\r\n        }\r\n      }, 1000)\r\n    }\r\n  }, [startTimer, timer])\r\n\r\n  const dispatch = useDispatch()\r\n  const verifyHandler = (e) => {\r\n    setCodeError(\"\")\r\n    e.preventDefault()\r\n\r\n    if (code.length === 4) {\r\n      dispatch(verifyEmailAction(Number(code)))\r\n    } else {\r\n      setCodeError(\"Code must be 4 Digits\")\r\n    }\r\n  }\r\n  const sendAgainHandler = () => {\r\n    if (!startTimer) {\r\n      setTimer(60)\r\n      setStartTimer(true)\r\n    }\r\n\r\n    dispatch(newCodeAction())\r\n  }\r\n\r\n  const history = useHistory()\r\n\r\n  const redirect = location.search.split(\"=\")[1]\r\n    ? location.search.split(\"=\")[1]\r\n    : \"/\"\r\n\r\n  const order = useSelector((state) => state.order)\r\n  useEffect(() => {\r\n    if (user.name) {\r\n      if (status === \"Verified\") {\r\n        order.error = null\r\n        history.push(redirect)\r\n      }\r\n    } else {\r\n      history.push(\"/login\")\r\n    }\r\n  }, [status, user, history])\r\n\r\n  useEffect(() => {\r\n    dispatch(newCodeAction())\r\n  }, [dispatch])\r\n\r\n  useEffect(() => {\r\n    if (!startTimer && newCodeError) {\r\n      setTimer(timerSeconds)\r\n      setStartTimer(true)\r\n    }\r\n  }, [newCodeError, startTimer, timerSeconds])\r\n\r\n  useEffect(() => {\r\n    if (newCodeLoading === false && !newCodeError) {\r\n      setTimer(60)\r\n      if (!startTimer) setStartTimer(true)\r\n    } else if (newCodeError === \"Email already Verified\") {\r\n      history.push(redirect)\r\n    }\r\n  }, [newCodeLoading, history, newCodeError, startTimer])\r\n\r\n  return (\r\n    <StyledVerify>\r\n      <div className='modelBox'>\r\n        <div className='danger'>\r\n          <div className='danger-text'>\r\n            <img src={danger} alt='danger' />\r\n            <p>\r\n              If you didn’t find the email in your Inbox, maybe It’s in your\r\n              Spam box\r\n            </p>\r\n          </div>\r\n          <div className='theRest'>\r\n            <h1>Enter Code to Verify</h1>\r\n            <Message\r\n              hidden='true'\r\n              vibrating='true'\r\n              visiblity={\r\n                codeError.length\r\n                  ? codeError\r\n                  : verificationError && !verifyLoading\r\n                  ? true\r\n                  : false\r\n              }\r\n              msg={\r\n                codeError.length\r\n                  ? codeError\r\n                  : verificationError\r\n                  ? verificationError.includes(\"timed out\")\r\n                    ? \"Network Error\"\r\n                    : verificationError.includes(\"mongo\")\r\n                    ? \"Server Error\"\r\n                    : verificationError\r\n                  : \"Ok\"\r\n              }\r\n              type='error'\r\n            />\r\n            <form className='verifyBtns' onSubmit={verifyHandler}>\r\n              {user && newCodeLoading === false && !newCodeError && (\r\n                <p className='emailSentMessage'>\r\n                  Email Sent to '{user.email}'{\" \"}\r\n                  <Link to='/changeEmail?redirect=verify'>Change Email</Link>\r\n                </p>\r\n              )}\r\n              <input\r\n                maxLength={4}\r\n                value={code}\r\n                onChange={(e) => setCode(e.target.value)}\r\n                type='number'\r\n                id='code'\r\n                placeholder='4 Digits Code'\r\n              />\r\n              <div className='btns'>\r\n                <button type='submit'>\r\n                  Verify {verifyLoading && <Loader />}\r\n                </button>\r\n                <p\r\n                  className={`${startTimer ? \"waitActive\" : \"\"}`}\r\n                  onClick={sendAgainHandler}\r\n                >\r\n                  {timer ? `Send again(${timer})` : \"Send again\"}\r\n                </p>\r\n              </div>\r\n            </form>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </StyledVerify>\r\n  )\r\n}\r\nconst StyledVerify = styled.div`\r\n  .emailSentMessage {\r\n    margin: 0.35rem 0;\r\n    margin-bottom: 0.5rem;\r\n    color: #3e3e3e;\r\n    font-size: calc(1rem + 0.2vw);\r\n    a {\r\n      color: #0084a0;\r\n    }\r\n  }\r\n  .waitActive {\r\n    filter: grayscale(0.2);\r\n    opacity: 0.7;\r\n    pointer-events: none;\r\n  }\r\n  .message {\r\n    align-self: flex-start;\r\n    margin-bottom: 0rem;\r\n  }\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  flex: 1 1 auto;\r\n  .modelBox {\r\n    border-radius: 12px;\r\n    box-shadow: -2px 4px 10px rgba(0, 0, 0, 0.2);\r\n    overflow: hidden;\r\n    display: flex;\r\n    justify-content: stretch;\r\n    align-items: stretch;\r\n  }\r\n\r\n  .danger {\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    flex-direction: column;\r\n    width: 100%;\r\n\r\n    .danger-text {\r\n      padding: 0.9rem calc(1.5rem + 1vw);\r\n      display: flex;\r\n      justify-content: center;\r\n      align-items: center;\r\n      background: #fffbd6;\r\n      width: 100%;\r\n      img {\r\n        width: calc(1.4rem + 0.05vw);\r\n        height: calc(1.4rem + 0.05vw);\r\n        margin-right: 0.4rem;\r\n      }\r\n      p {\r\n        font-size: calc(0.85rem + 0.3vw);\r\n        color: #715100;\r\n      }\r\n    }\r\n  }\r\n  .theRest {\r\n    padding: calc(1.5rem + 1vw);\r\n    flex: 1 1 auto;\r\n    width: 100%;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    flex-direction: column;\r\n    h1 {\r\n      color: #1a1a1a;\r\n      font-weight: 500;\r\n      font-size: calc(2.2rem + 0.3vw);\r\n      align-self: flex-start;\r\n      margin-bottom: calc(1rem + 0.3vh);\r\n    }\r\n    input {\r\n      background: #f3f3f3;\r\n      border: none;\r\n      border-radius: 5px;\r\n      font-size: calc(1.1rem + 0.3vw);\r\n      padding: 0.5rem 1rem;\r\n      margin-bottom: calc(1.4rem + 0.3vh);\r\n    }\r\n    .verifyBtns {\r\n      display: flex;\r\n      flex-direction: column;\r\n      width: 100%;\r\n      button {\r\n        display: flex;\r\n        justify-content: space-between;\r\n        align-items: center;\r\n        padding: 0.4rem 1.3rem;\r\n        border: none;\r\n        color: white;\r\n        background: #00b2d8;\r\n        border-radius: 6px;\r\n        font-size: calc(1.2rem + 0.3vw);\r\n        cursor: pointer;\r\n        transition: 0.1s ease;\r\n        &:hover {\r\n          background: #00bde7;\r\n        }\r\n        #loader:first-child {\r\n          width: calc(0.9rem + 0.5vw);\r\n          height: calc(0.9rem + 0.5vw);\r\n          margin-left: 0.45rem;\r\n          #greybackground path {\r\n            stroke: white;\r\n          }\r\n        }\r\n      }\r\n      .btns {\r\n        width: 100%;\r\n        display: flex;\r\n        justify-content: space-between;\r\n        align-items: flex-end;\r\n        p {\r\n          font-size: calc(0.9rem + 0.2vw);\r\n          cursor: pointer;\r\n          color: #0084a0;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  @media screen and (max-width: 1050px) {\r\n    .emailSentMessage {\r\n      font-size: calc(0.8rem + 0.2vw);\r\n    }\r\n    .message {\r\n      span {\r\n        font-size: calc(0.7rem + 0.1vw) !important;\r\n      }\r\n    }\r\n    margin-top: calc(2rem + 0.3vh);\r\n    align-items: flex-start;\r\n    .danger {\r\n      .danger-text {\r\n        padding: 0.9rem calc(1rem + 1vw);\r\n        img {\r\n          width: calc(1.3rem + 0.05vw);\r\n          height: calc(1.3rem + 0.05vw);\r\n          margin-right: 0.55rem;\r\n        }\r\n        p {\r\n          font-size: calc(0.7rem + 0.3vw);\r\n        }\r\n      }\r\n    }\r\n    .theRest {\r\n      padding: calc(0.85rem + 1vw) calc(1rem + 1vw) calc(1rem + 1vw)\r\n        calc(1rem + 1vw);\r\n      h1 {\r\n        font-size: calc(1.6rem + 0.3vw);\r\n        margin-bottom: calc(0.7rem + 0.3vh);\r\n      }\r\n      input {\r\n        margin-bottom: calc(1rem + 0.3vh);\r\n      }\r\n    }\r\n    .modelBox {\r\n      width: 90%;\r\n      border: unset;\r\n      border-radius: 12px;\r\n      box-shadow: -2px 4px 10px rgba(0, 0, 0, 0.2);\r\n    }\r\n    .verifyBtns {\r\n      display: flex;\r\n      flex-direction: column;\r\n      width: 100%;\r\n    }\r\n  }\r\n`\r\n\r\nexport default Verify\r\n"],"sourceRoot":""}